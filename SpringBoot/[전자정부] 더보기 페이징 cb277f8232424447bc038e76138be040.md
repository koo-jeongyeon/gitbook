# [전자정부] 더보기 페이징

생성일: 2021년 1월 14일 오후 3:08

```java
처음에 더보기가없을때
1.처음에 10개에리스트를 가져올때 총갯수를 센다
2.그 갯수를 모델로넘겨줘서 10개 보다 작거나 같으면 더보기 하이드 시켜줌
 
 
------------------------------------------------------------------------------------
더보기 클릭하다가더보기가 없는 순간
1. 10개리스트를마저 가져오고,,
2. 그 리스트에마지막인덱스를 가져옴
3. 그인덱스보다 큰인덱스를 가진 값이 있는지 쿼리문으로 카운트 확인
4. 새페이지를생성해서 쿼리문으로 확인한 카운트 갯수를 넘겨줌 
5. 카운트가 0이면hide 시켜줌
	
	@RequestMapping(value= "/showLottoList.do")
	publicString showLottoList(HttpServletRequest request, ModelMap model) throwsException {
		List<?>list = (List<?>) sampleDAO.list("selectLottoListlimit10");
		model.addAttribute("resultList",list);
		 
		 
		Int lottocount = (int)sampleDAO.select("selectLottoListCount");
		model.addAttribute("lottocount",lottocount);
		return"lottoRankingFriend/lottoList";
	}        
	@RequestMapping(value= "/showLottoadderList.do")
	publicString showLottoadderList(HttpServletRequest request, ModelMap model) throwsException {
		String endidx = request.getParameter("endidx");
		EgovMap adderin = new EgovMap();
		adderin.put("endidx",endidx);
		 
		List<?>list = (List<?>) sampleDAO.list("selectLottoListlimit10Adder",adderin);
		model.addAttribute("resultList",list);
		 
		model.addAttribute("endidx",endidx);
		return"lottoRankingFriend/lottoListAdder";
	}        
	@RequestMapping(value= "/getLottoExtraCount.do")
	publicString getExtraCountLotto(HttpServletRequest request, ModelMap model) throwsException {
		System.out.println("extcount");
		Stringendidx = request.getParameter("endidx");
		EgovMapadderin = new EgovMap();
		adderin.put("endidx",endidx);
		//List<?>list = (List<?>) sampleDAO.list("selectRankingList");
		List<?>list = (List<?>) sampleDAO.list("selectLottoListlimit10Adder",adderin);
		model.addAttribute("resultList",list);
		 
		System.out.println("1");
		 
		EgovMap m = (EgovMap)list.get( list.size()-1 ); //마지막데이터
		String midx = ""+m.get("idx");//마지막데이터 인덱스 가져옴
		System.out.println("2");
		//마지막인덱스 이후의 갯수세기
		System.out.println("midx:"+midx);
		EgovMapin = new EgovMap();
		in.put("midx",midx);
		 
		System.out.println("3");
		intlastcount = (int) sampleDAO.select("selectLottolastCount", in);
		System.out.println("4");
		model.addAttribute("lastcount",lastcount);
		 
		System.out.println("lastcount:"+lastcount);
		model.addAttribute("endidx",endidx);
		return"lottoRankingFriend/rankingListAdder2";
	}
	 
	---------------------------------------------------------------------------------------------
	 
	 
	<selectid="selectLottoList" resultClass="EgovMap">
	        <![CDATA[
	            SELECT *
	            FROM lotto
	        ]]>
	</select>
	<selectid="selectLottoListCount" resultClass="int">
	        <![CDATA[
	            SELECT count(*) lottocount
	            FROM lotto
	        ]]>
	</select>
	<selectid="selectLottoListlimit10" resultClass="EgovMap">
	        <![CDATA[
	            SELECT *
	            FROM lotto
	            order by roundnum
	            limit 10
	        ]]>
	</select>
	<selectid="selectLottoListlimit10Adder" resultClass="EgovMap">
	        <![CDATA[
	            SELECT *
	            FROM lotto
	            order by roundnum
	            limit $endidx$,10
	        ]]>
	</select>
	<selectid="selectLottolastCount" resultClass="int">
	        <![CDATA[
	         select count(*) lastcount from
	           ( SELECT *
	            FROM lotto
	            order by roundnum) a
	           
	            where a.idx > #midx#
	        ]]>
	</select>
	 
	 
	---------------------------------------------------------------------------------------------
	 
	lottoList.jsp
	 
	    <script src="//code.jquery.com/jquery.min.js"></script>
	 
	 
	    <script>
	    var ranking = 0;
	  function ajaxGOL(){
		  ranking+=10;
		 
		  jQuery.ajax({
		    type:"GET",
		    url :"/rsp/showLottoadderList.do?endidx=" +ranking,
		    success : function(data) {
		       var obj=document.getElementById("mid_listL" );
		       obj.innerHTML += data;
		       GetExtraCount();
		     },
		     complete : function(data) {               },
		     error : function(xhr, status , error){console.log("ajax ERROR!!! : " + kind);}
		  });
	  }
	  function GetExtraCount(){
		  jQuery.ajax({
		    type:"GET",
		    url :"/rsp/getLottoExtraCount.do?endidx=" +ranking,
		    success : function(data) {
		      if(parseInt(data) <= 0 ){
		             $("#addb").hide();
		      }
		     },
		     complete : function(data) {               },
		     error : function(xhr, status , error){console.log("ajax ERROR!!! : " + kind);}
		  });
	  }
	  </script>
	 
	 
	 
	 
	          <div id="mid_listL"></div>
	          <c:if test="${lottocount >10}">
	         <div class="nextpage" id="addb"><ahref="#" onclick="ajaxGOL()" class="link w-button">더보기+</a></div>
	          </c:if>
	 
	---------------------------------------------------------------------------------------------
	 
	lottoListAdder.jsp
	 
	<%@page contentType="text/html; charset=utf-8"pageEncoding="utf-8"%>
	<%@taglib prefix="c"     uri="http://java.sun.com/jsp/jstl/core" %>
	<%@taglib prefix="form"  uri="http://www.springframework.org/tags/form" %>
	<%@taglib prefix="ui"    uri="http://egovframework.gov/ctl/ui"%>
	<%@taglib prefix="spring"uri="http://www.springframework.org/tags"%>
	 
	 <c:forEach var="result"items="${resultList }" varStatus="status"  >
	          <divclass="realcolumnbox">
	            <div class="realc2levelcc" style="width:50%">
	                   
	                   회차${result.roundnum}
	                   
	            </div>
	           
	            <div class="realc2"style="width:50%">
	              <divclass="text-block-18">${result.number}</div>
	            </div>
	           
	          </div>
	</c:forEach>
	 
	---------------------------------------------------------------------------------------------
	 
	lottoListAdder2.jsp
	 
	<%@page contentType="text/html; charset=utf-8"pageEncoding="utf-8"%>
	<%@taglib prefix="c"     uri="http://java.sun.com/jsp/jstl/core" %>
	<%@taglib prefix="form"  uri="http://www.springframework.org/tags/form" %>
	<%@taglib prefix="ui"    uri="http://egovframework.gov/ctl/ui"%>
	<%@taglib prefix="spring"uri="http://www.springframework.org/tags"%>
	<%@taglib prefix="fmt"uri="http://java.sun.com/jsp/jstl/fmt"%>
	 
	${lastcount}
	 

출처: <https://cafe.naver.com/common/editor/default.html>
```